/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View.form;

import java.util.ArrayList;

import javax.swing.JOptionPane;

import Model.DAO.MarksDAO;
import Model.transfer_object.MarksTO;
import View.main.mainGui;

public class Form_3 extends javax.swing.JPanel {
	private mainGui main = null;
	/**
	 * Creates new form Form_1
	 */
	private MarksDAO marks = new MarksDAO();

	public Form_3() {
		initComponents();
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	@SuppressWarnings("unchecked")
	// <editor-fold defaultstate="collapsed" desc="Generated
	// Code">//GEN-BEGIN:initComponents
	private void initComponents() {

		jPanel3 = new javax.swing.JPanel();
		jLabel3 = new javax.swing.JLabel();
		jButton1 = new javax.swing.JButton();
		jComboBox1 = new javax.swing.JComboBox<>();
		jPanel4 = new javax.swing.JPanel();
		jLabel5 = new javax.swing.JLabel();
		jLabel4 = new javax.swing.JLabel();
		jLabel6 = new javax.swing.JLabel();
		jLabel7 = new javax.swing.JLabel();
		jTextField2 = new javax.swing.JTextField();
		jLabel8 = new javax.swing.JLabel();
		jComboBox2 = new javax.swing.JComboBox<>();
		jTextField3 = new javax.swing.JTextField();
		jTextField4 = new javax.swing.JTextField();
		jTextField5 = new javax.swing.JTextField();
		jScrollPane1 = new javax.swing.JScrollPane();
		jTable1 = new javax.swing.JTable();
		jLabel1 = new javax.swing.JLabel();
		jLabel8.setVisible(false);
		jTextField2.setVisible(false);
		jPanel3.setBackground(new java.awt.Color(255, 255, 255));
		jPanel3.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null,
				new java.awt.Color(0, 153, 153), null, null));
		jPanel3.setToolTipText("");

		jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel3.setText("Queries :");

		jButton1.setBackground(new java.awt.Color(85, 155, 118));
		jButton1.setText("Execute");
		jButton1.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				// jButton1ActionPerformed(evt);
				if (jTextField3.getText().equals("")) {
					JOptionPane.showMessageDialog(main, "Please Enter Educational Year");
				} else if (jTextField4.getText().equals("")) {
					JOptionPane.showMessageDialog(main, "Please Enter Stream in proper format");
				} else if (jTextField5.getText().equals("")) {
					JOptionPane.showMessageDialog(main, "Please Enter Course Name");
				} else {
					String selectedValue = (String) jComboBox1.getSelectedItem();
					if (selectedValue.equals("Average Marks In a Subject")) {
						if (jTextField2.getText().equals("")) {
							JOptionPane.showMessageDialog(main, "Please Enter the subject");
						} else {
							String ch = "3";
							String[] opearation3 = { ch, jTextField4.getText().trim(),
									jComboBox2.getSelectedItem().toString().trim(), jTextField3.getText().trim(),
									jTextField5.getText().trim(), jTextField2.getText().trim() };
							ArrayList<MarksTO> retrieveAvgMarksInASubject = marks.retriveDataBase(opearation3);
							if (retrieveAvgMarksInASubject != null) {
								for (MarksTO marksto : retrieveAvgMarksInASubject) {
									JOptionPane.showMessageDialog(main, "Average Marks is: " + marksto.getMarksObt());
								}
							} else
								JOptionPane.showMessageDialog(main, "No Data Found");
						}

					}
					if (selectedValue.equals("Average Marks In a Semester")) {
						String ch = "4";
						String[] opearation3 = { ch, jTextField4.getText().trim(),
								jComboBox2.getSelectedItem().toString().trim(), jTextField3.getText().trim(),
								jTextField5.getText().trim() };
						ArrayList<MarksTO> retrieveAvgMarksInASubject = marks.retriveDataBase(opearation3);
						if (retrieveAvgMarksInASubject != null) {
							for (MarksTO marksto : retrieveAvgMarksInASubject) {
								JOptionPane.showMessageDialog(main, "Average Marks is: " + marksto.getMarksObt());
							}
						} else
							JOptionPane.showMessageDialog(main, "No Data Found");

					}
					if (selectedValue.equals("Highest Marks In a Semester")) {
						String ch = "22";
						String[] opearation3 = { ch, jTextField4.getText().trim(),
								jComboBox2.getSelectedItem().toString().trim(), jTextField3.getText().trim(),
								jTextField5.getText().trim() };
						ArrayList<MarksTO> retrieveMaxMarksInASem = marks.retriveDataBase(opearation3);
						if (retrieveMaxMarksInASem != null) {
							javax.swing.table.DefaultTableModel model = (javax.swing.table.DefaultTableModel) jTable1
									.getModel();
							model.setRowCount(0);
							for (MarksTO marksto : retrieveMaxMarksInASem) {

								model.addRow(new Object[] { marksto.getColl(), marksto.getCate(), marksto.getNumber(),
										marksto.getMarksObt() });
							}
						} else
							JOptionPane.showMessageDialog(main, "No Data Found");
					}
					if (selectedValue.equals("Highest Marks In a Subject")) {
						if (jTextField2.getText().equals("")) {
							JOptionPane.showMessageDialog(main, "Please Enter the subject");
						} else {
							String ch = "1";
							String[] opearation3 = { ch, jTextField4.getText().trim(),
									jComboBox2.getSelectedItem().toString().trim(), jTextField3.getText().trim(),
									jTextField5.getText().trim(),jTextField2.getText().toUpperCase().trim()};
							ArrayList<MarksTO> retrieveMaxMarksInASubject = marks.retriveDataBase(opearation3);
							if (retrieveMaxMarksInASubject != null) {
								javax.swing.table.DefaultTableModel model = (javax.swing.table.DefaultTableModel) jTable1
										.getModel();
								model.setRowCount(0);
								for (MarksTO marksto : retrieveMaxMarksInASubject) {
		
									model.addRow(new Object[] { marksto.getColl(), marksto.getCate(),
											marksto.getNumber(), marksto.getMarksObt() });
								}
							} else
								JOptionPane.showMessageDialog(main, "No Data Found");
						}
					}

				}
			}
		});

		jComboBox1.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Highest Marks In a Semester",
				"Highest Marks In a Subject", "Average Marks In a Semester", "Average Marks In a Subject" }));
		jComboBox1.setBorder(javax.swing.BorderFactory.createEmptyBorder(1, 1, 1, 1));
		jComboBox1.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				String selectedValue = (String) jComboBox1.getSelectedItem();

				if ("Highest Marks In a Subject".equals(selectedValue)
						|| "Average Marks In a Subject".equals(selectedValue)) {
					jLabel8.setVisible(true);
					jTextField2.setVisible(true);
				} else {
					jLabel8.setVisible(false);
					jTextField2.setVisible(false);
				}
				jComboBox1ActionPerformed(evt);
			}
		});

		jPanel4.setBackground(new java.awt.Color(255, 255, 255));
		jPanel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null,
				new java.awt.Color(0, 204, 102), null, null));

		jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel5.setText("Stream:");

		jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel4.setText("Semester:");

		jLabel6.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel6.setText("Year:");

		jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel7.setText("Course:");

		jTextField2.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jTextField2ActionPerformed(evt);
			}
		});

		jLabel8.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
		jLabel8.setText("Subject:");

		jComboBox2.setModel(new javax.swing.DefaultComboBoxModel<>(
				new String[] { "I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX", "X" }));
		jComboBox2.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jComboBox2ActionPerformed(evt);

			}
		});

		jTextField3.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jTextField3ActionPerformed(evt);
			}
		});

		jTextField4.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jTextField4ActionPerformed(evt);
			}
		});

		jTextField5.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jTextField5ActionPerformed(evt);
			}
		});

		javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
		jPanel4.setLayout(jPanel4Layout);
		jPanel4Layout.setHorizontalGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(jPanel4Layout.createSequentialGroup().addContainerGap().addGroup(jPanel4Layout
						.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
						.addGroup(jPanel4Layout.createSequentialGroup().addComponent(jLabel5).addGap(18, 18, 18)
								.addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, 276,
										javax.swing.GroupLayout.PREFERRED_SIZE))
						.addGroup(jPanel4Layout.createSequentialGroup().addComponent(jLabel4).addGap(18, 18, 18)
								.addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
										.addGroup(jPanel4Layout.createSequentialGroup().addComponent(jLabel8)
												.addGap(31, 31, 31).addComponent(jTextField2,
														javax.swing.GroupLayout.PREFERRED_SIZE, 399,
														javax.swing.GroupLayout.PREFERRED_SIZE))
										.addGroup(jPanel4Layout.createSequentialGroup()
												.addGroup(jPanel4Layout
														.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
														.addComponent(jLabel6)
														.addGroup(jPanel4Layout.createSequentialGroup()
																.addComponent(jComboBox2,
																		javax.swing.GroupLayout.PREFERRED_SIZE, 239,
																		javax.swing.GroupLayout.PREFERRED_SIZE)
																.addGap(51, 51, 51).addComponent(jLabel7)))
												.addGap(18, 18, 18)
												.addGroup(jPanel4Layout
														.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
														.addComponent(jTextField3,
																javax.swing.GroupLayout.PREFERRED_SIZE, 276,
																javax.swing.GroupLayout.PREFERRED_SIZE)
														.addComponent(jTextField5,
																javax.swing.GroupLayout.PREFERRED_SIZE, 276,
																javax.swing.GroupLayout.PREFERRED_SIZE))))))
						.addContainerGap(67, Short.MAX_VALUE)));
		jPanel4Layout.setVerticalGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(jPanel4Layout.createSequentialGroup().addGap(20, 20, 20).addGroup(jPanel4Layout
						.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jLabel6)
						.addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
								.addComponent(jLabel5)
								.addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
								.addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
						.addGap(35, 35, 35)
						.addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
								.addComponent(jLabel4)
								.addComponent(jComboBox2, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
								.addComponent(jLabel7).addComponent(jTextField5, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
						.addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 32, Short.MAX_VALUE)
						.addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
								.addComponent(jLabel8).addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
						.addGap(14, 14, 14)));

		jTable1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED,
				new java.awt.Color(0, 51, 51), new java.awt.Color(0, 153, 153), null, null));
		jTable1.setModel(new javax.swing.table.DefaultTableModel(new Object[][] { { null, null, null, null } },
				new String[] { "Coll", "Cate", "Number", "Marks" }) {
			Class[] types = new Class[] { java.lang.String.class, java.lang.String.class, java.lang.String.class,
					java.lang.String.class };
			boolean[] canEdit = new boolean[] { false, false, false, false };

			public Class getColumnClass(int columnIndex) {
				return types[columnIndex];
			}

			public boolean isCellEditable(int rowIndex, int columnIndex) {
				return canEdit[columnIndex];
			}
		});
		jTable1.setFocusable(false);
		jTable1.setRequestFocusEnabled(false);
		jTable1.setRowSelectionAllowed(false);
		jTable1.setUpdateSelectionOnSort(false);
		jScrollPane1.setViewportView(jTable1);

		jLabel1.setBackground(new java.awt.Color(255, 255, 255));
		jLabel1.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
		jLabel1.setText("   Query Processing");
		jLabel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null,
				new java.awt.Color(0, 255, 102), null, null));

		javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
		jPanel3.setLayout(jPanel3Layout);
		jPanel3Layout.setHorizontalGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(jPanel3Layout.createSequentialGroup().addGap(31, 31, 31)
						.addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
								.addComponent(jScrollPane1)
								.addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
								.addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
										.addComponent(jButton1)
										.addGroup(jPanel3Layout.createSequentialGroup()
												.addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 240,
														javax.swing.GroupLayout.PREFERRED_SIZE)
												.addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
												.addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE, 316,
														javax.swing.GroupLayout.PREFERRED_SIZE)))
								.addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
						.addContainerGap(90, Short.MAX_VALUE)));
		jPanel3Layout.setVerticalGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
				.addGroup(jPanel3Layout.createSequentialGroup().addGap(35, 35, 35)
						.addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 63,
								javax.swing.GroupLayout.PREFERRED_SIZE)
						.addGap(18, 18, 18)
						.addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
								.addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 34,
										javax.swing.GroupLayout.PREFERRED_SIZE)
								.addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE,
										javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
						.addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(jButton1)
						.addGap(5, 5, 5)
						.addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE,
								javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
						.addGap(18, 18, 18).addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 164,
								javax.swing.GroupLayout.PREFERRED_SIZE)
						.addContainerGap(12, Short.MAX_VALUE)));

		javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
		this.setLayout(layout);
		layout.setHorizontalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(
				javax.swing.GroupLayout.Alignment.TRAILING,
				layout.createSequentialGroup().addContainerGap(14, Short.MAX_VALUE)
						.addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE,
								javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
						.addContainerGap()));
		layout.setVerticalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(
				javax.swing.GroupLayout.Alignment.TRAILING,
				layout.createSequentialGroup().addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
						.addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE,
								javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
						.addContainerGap(9, Short.MAX_VALUE)));
	}// </editor-fold>//GEN-END:initComponents

	private void jTextField5ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jTextField5ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jTextField5ActionPerformed

	private void jTextField4ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jTextField4ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jTextField4ActionPerformed

	private void jTextField3ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jTextField3ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jTextField3ActionPerformed

	private void jComboBox2ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jComboBox2ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jComboBox2ActionPerformed

	private void jTextField2ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jTextField2ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jTextField2ActionPerformed

	private void jComboBox1ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jComboBox1ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jComboBox1ActionPerformed

	private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_jButton1ActionPerformed
		// TODO add your handling code here:
	}// GEN-LAST:event_jButton1ActionPerformed

	// Variables declaration - do not modify//GEN-BEGIN:variables
	private javax.swing.JButton jButton1;
	private javax.swing.JComboBox<String> jComboBox1;
	private javax.swing.JComboBox<String> jComboBox2;
	private javax.swing.JLabel jLabel1;
	private javax.swing.JLabel jLabel3;
	private javax.swing.JLabel jLabel4;
	private javax.swing.JLabel jLabel5;
	private javax.swing.JLabel jLabel6;
	private javax.swing.JLabel jLabel7;
	private javax.swing.JLabel jLabel8;
	private javax.swing.JPanel jPanel3;
	private javax.swing.JPanel jPanel4;
	private javax.swing.JScrollPane jScrollPane1;
	private javax.swing.JTable jTable1;
	private javax.swing.JTextField jTextField2;
	private javax.swing.JTextField jTextField3;
	private javax.swing.JTextField jTextField4;
	private javax.swing.JTextField jTextField5;
	// End of variables declaration//GEN-END:variables
}
